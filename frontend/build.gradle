task yarnInstall(type: Exec) {
	inputs.file 'package.json'
	outputs.file 'yarn.lock'
	commandLine 'yarn'
}

task buildDlls(type: Exec) {
    inputs.file 'yarn.lock'
    inputs.dir 'tooling'
    outputs.dir 'dist'
    
    commandLine 'yarn', 'run', 'dll:prod'

    dependsOn yarnInstall
}

task assemble(type: Exec) {
	inputs.dir 'src'
	inputs.dir 'flow'
    inputs.dir 'tooling'
	outputs.dir 'dist'

	commandLine 'yarn', 'run', 'build:prod'

    dependsOn buildDlls
	dependsOn yarnInstall
}
//
//task test(type: Exec) {
//	inputs.dir 'src'
//	inputs.dir 'flow'
//
//	commandLine 'yarn', 'test'
//
//	dependsOn yarnInstall
//}
//
//task check {
//	dependsOn test
//}

task build {
	dependsOn assemble
//	dependsOn check
}

task clean(type: Delete) {
	delete 'dist'
}
